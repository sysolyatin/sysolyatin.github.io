---
layout: post
title:  "Управление медиасервером Resolume из grandMA2"
cover: "/static/notes/resolume-ma2/cover.png"
---
### Вступление или ответ на вопрос «Это вообще что?»

Как говорят многие художники по свету: «Экран — это тоже световой прибор». Ну и логично, что и управлять этим световым прибором хочется так же со светового пульта.

Но обо всём по порядку. Вдруг кто-то не знает, что такое Resolume. Если описать простыми словами, то это специализированный софт для Windows и Mac, который позволяет запускать видео на внешние экраны, использовать слои из нескольких видео, накладывать различные эффекты, имеет встроенные генераторы контента и многое другое. А выходную картинку из этого софта можно всячески геометрически деформировать, разрезать на части для вывода на разные экраны и проекторы, в общем делать много-много всего интересного.

И зачем же нам нужно управлять этим медиасервером со светового пульта? Тут вариантов может быть много, вот самые распространённые:

- Постробить экраном вместе с какой-либо группой приборов, например заливкой
- Возможность гасить весь ненужный свет во время работы определённых приборов (например, во время красного контрового строба выключить вообще всё и создать полную темноту)
- Переключение видеофайлов в Resolume во время запуска определенных кьюшек
- [Автоматическое разукрашивание контента в Resolume](/light/resolume-color/), например, в цвет заливки

но этим точно не ограничивается список, всё зависит от вашей фантазии.

Resolume умеет принимать управляющий сигнал по Art-Net, а наш пульт умеет отдавать такой сигнал (совпадение?). Поэтому в рамках этой статьи мы сделаем такую связку и научим нашу МАшу рулить видеорядом.

### Настройка сети

Для того, чтобы принять сигнал Art-Net от MA, нужно иметь на компе с Resolume сетевуху с адресом из сети 2.0.0.0/8 или 10.0.0.0/8, для дальнейших примеров мы остановимся на первом варианте. Если Resolume и MA находятся на разных устройствах, то их нужно просто соединить между собой и дать каждому устройству адрес из выбранной подсети, например, пульту 2.0.0.10 с майской 255.0.0.0, а компу с Resolume 2.0.0.20 с такой же маской.

Но в рамках данной статьи мы разместим Resolume на одном компе с MA onPC, поэтому нам нужно сделать виртуальный адаптер с адресом из указанной выше подсети, куда MA сможет слать сигнал управления, а Resolume читать его от туда.

> Виртуальный адаптер нужен только для случаев, когда у компа нет физического интерфейса с адресом в нужной подсети! Например, если вы уже используете артгейт, то для локального соединения с Resolume можно использовать уже существующий физический сетевой адаптер.

О том, как сделать виртуальный интерфейс и правильно его настроить, очень хорошо написал Александр Сальцев в своей [статье «Виртуальный ArtNet»](https://alexsaltsev.ru/2020/02/%d0%b2%d0%b8%d1%80%d1%82%d1%83%d0%b0%d0%bb%d1%8c%d0%bd%d1%8b%d0%b9-artnet/). Я сделал сетевуху по его инструкции с названием LOCAL_ARTNET и адресом 2.0.0.15.

### Настройка Art-Net со стороны Resolume

Необходимо открыть настройки, выбрать раздел DMX и указать необходимый сетевой интерфейс

![](/static/notes/resolume-ma2/image-5.png)

Потом нужно нажать кнопку **New Input** и появятся настройки входа. Для примера мы будем использовать четвертый юниверс в MA, в Resolume нумерация начинается с 0, поэтому выбираем 3. Для удобства проверки того, что всё заработало, рекомендую открыть окно мониторинга входящего сигнала и выбрать там этот же третий юниверс:

![](/static/notes/resolume-ma2/image-6.png)

### Настройка Art-Net со стороны grandMA

Если у вас физический пульт, то для Art-Net у него есть отдельный сетевой интерфейс, скорее всего, вы знаете, как его настраивать, а если нет, информацию о настройке сетевухи из самого пульта можно найти в документации.

Мы же рассмотрим более сложный вариант с настройкой сети в рамках MA onPC. В первую очередь необходимо поднять сессию на адресе, который будет доступен для Art-Net. Заходим в MA Network Control

![](/static/notes/resolume-ma2/image.png)

Тут необходимо выбрать сетевуху с необходимым адресом

![](/static/notes/resolume-ma2/image-1.png)

Перезапустить MA, зайти ещё раз в это окно и создать сессию на этом адресе. Должно получиться примерно так:

![](/static/notes/resolume-ma2/image-2.png)

Теперь нужно пойти в Network Protocols

![](/static/notes/resolume-ma2/image-3.png)

И включить выход Art-Net

![](/static/notes/resolume-ma2/image-4.png)

> Для работы Art-Net выхода необходимо иметь доступные параметры в MA, которые на onPC можно получить, подключив железо MA Lighting, например, крыло или ноду с параметрами.

По умолчанию в пульте уже добавлена строчка одного Art-Net выхода, которая отправляет во всю сеть первые 8 юниверсов. Для соединения с резолюмом нам её будет достаточно, а если вдруг захотите подробнее прочитать про настройку Art-Net в MA2, я думаю, вы найдете, где это сделать.

### Патч резолюма в МА

Для более старых версий Resolume в МА была специальная библиотека для слоя и библиотека для композиции, с кучей каналов и ненужных параметров. Видимо создатели поняли, что это не очень удобно, и теперь резолюм можно патчить в пульт только в «свободном варианте».
Для обычных действий, например, яркость слоя, кнопка включения эффекта, переключения клипа и т.д. я использую обычные диммерные каналы в пульте.

Откроем окно патча в МА, создадим новый слой resolume и добавим в него 10 диммеров на любых адресах четвертого юниверса:

![](/static/notes/resolume-ma2/image-8.png)

Теперь вращая колесо диммера для первого прибора на окне мониторинга входящего DMX сигнала в Resolume вы должны увидеть изменения:

![](/static/notes/resolume-ma2/image-9.png)

Если это не произошло — ещё раз внимательно прочитайте всю статью выше этого абзаца проверьте все настройки. Если вы увидели изменения на графике в окне мониторинга — поздравляю! Вы подключили Resolume к grandMA2!

Для примера теперь запатчим пару функций в Resolume на экзекьюторы пульта. Очистите программатор, выберите первый прибор, откройте его на 100% и запишите на первый экзекьютор, как будто это будет просто управление яркостью первого прожектора:

![](/static/notes/resolume-ma2/image-10.png)

Затем в настройках шорткатов в резолюме выберите редактирование DMX и нажмите мышкой на фейдер яркости слоя композиции

![](/static/notes/resolume-ma2/image-11.png)

Теперь в настройках шорткатов можно нажать **Stop**, запустить какой-нибудь клип и подергать фейдер первого экзекьютора в МА. Теперь он управляет яркостью композиции.

Теперь возьмите второй прибор, откройте его на 100%, запишите на экзекьютор-кнопку, например, 101 и сделайте тип кнопки Flash, очистите программатор.

![](/static/notes/resolume-ma2/image-13.png)

Накиньте эффект стробоскопа на композицию, отрегулируйте его частоту и отключите (В)

![](/static/notes/resolume-ma2/image-14.png)

Аналогично предыдущему действию, откройте включите режим обучения шорткатов по DMX, выберите кнопку выключения эффекта, нажмите на пульте 101 экзекьютор, у кнопки появится номер канала. После этого справа в редакторе этого шортката необходимо нажать галочку на пункте Invert Value.

![](/static/notes/resolume-ma2/image-15.png)

Теперь в настройках шорткатов можно нажать **Stop**, и попробовать нажать кнопку 101 экзекьютора в пульте. В момент нажатия должен срабатывать эффект стробоскопа, а после отпускания кнопки — выключаться.

Аналогичным образом можно патчить любые действия в Resolume — параметры любых эффектов, переключение композиций, яркости, громкости и т.д. В общем всё, что душе угодно.
Ну и конечно же в патче МА диммерных каналов было 10 штук просто для примера, их может быть любое необходимое вам значение (ну или сколько параметров хватит 😀).

Надеюсь, эта статья чем-то смогла вам помочь и хоть немного сделала вашу жизнь проще, а ваше шоу краше!

*Парочка приятных комментариев к этой статье из предыдущей версии сайта:*

![](/static/notes/resolume-ma2/comments.png)