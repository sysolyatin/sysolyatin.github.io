---
layout: post
title:  "Подключение Stream Deck к МА2"
---

Во времена пандемии прямые трансляции и стримы стали ещё более популярны, чем были до неё, а так как спрос рождает предложения, компания Elgato разработала устройство Stream Deck. 
Это клавиатура, у которой каждая кнопка - это мини-экран, с помощью специального софта можно назначить любое изображение или текст на любую кнопку, а так же любое действие в теоретически любом софте.

![](/static/notes/companion/000.png)

Но так, как устройство предназначалось в первую очередь для стриммеров (что даже видно из его названия), то его родной софт управления не особо умеет во всякие шоу-технологии, а всем хотелось бы такую клавиатуру подключить к пульту или медиасерверу. 

Но как уже говорил выше - спрос рождает предложения, поэтому компания Bitfocus создала приложение для управления Stream Deck, которое называется Companion. Мало того, что это открытый софт, под который можно написать свой плагин для любого софта/устройства, так там ещё и "из коробки" есть большинство необходимых нам шоу-технологий, в их числе и пульт grandMA2.

Далее я расскажу, как установить и настроить Companion для работы с grandMA2. В первую очередь его нужно скачать, сделать это можно на официальном сайте приложения [https://bitfocus.io/companion](https://bitfocus.io/companion)

![](/static/notes/companion/001.png)

Для этого придется там зарегистрироваться, нужно подтверждение регистрации через почту, но всякие  временные почты срабатывают. После регистрации входим на сайт под своей учеткой и переходим в раздел загрузок. Нам нужен Companion стабильной версии, при нажатии на кнопку версии можно выбрать операционную систему, так как мы будем использовать Companion локально вместе с MA2 -  выбираем Windows. 

![](/static/notes/companion/002.png)

Далее приложение необходимо установить на компьютер, и после его запуска мы увидим такое окно:

![](/static/notes/companion/003.png)

Вся работа с приложением происходит в браузере, а в этом окне необходимо выбрать сетевой интерфейс и порт, на котором будет доступно основное приложение в браузере.

По умолчанию это *127.0.0.1:8888*. Если мы будем работать только локально только с МА - можно оставить такой вариант, если к компаньону нужен доступ с других устройств, выбираем интерфейс, на котором поднята ваша основная сеть. Я оставлю 127.0.0.1.

Далее захожу в обычном браузере по этому адресу (127.0.0.1:8888) и в окне приветствия просто соглашаюсь со всем, что там есть:

![](/static/notes/companion/004.png)

Теперь необходимо настроить МА, обязательно нужно поднять сессию, а потом идем в глобальные настройки и включаем telnet:

![](/static/notes/companion/005.png)

На этом все, в МА больше делать ничего не нужно. Возвращаемся в браузер, теперь необходимо подключить компаньон к МА. В разделе Connections добавляем новое с названием *MA Lighting 2*.

![](/static/notes/companion/006.png)

Для локального использования вводим адрес 127.0.0.1, вводим **ваш** логин и пароль. После нажатия кнопки сохранить должен измениться статус подключения на зелёный в левой половине окна.

![](/static/notes/companion/007.png)

Если это не произошло - внимательно проверьте всё ещё раз по инструкции выше.

Теперь необходимо добавить подключения к устройству Stream Deck. Это делается в разделе Surfaces. Если оно само не появилось до этого - нажимаем Rescan USB.

![](/static/notes/companion/008.png)

На кнопках Stream Deck появятся три дефолтные кнопки. Если это не произошло - внимательно проверьте всё ещё раз по инструкции выше.

![](/static/notes/companion/009.png)

Теперь переходим раздел Buttons и кнопкой Delete (помечена на скриншоте) удаляем дефолтные кнопки.

![](/static/notes/companion/010.png)

Теперь можно приступить к созданию своих. Нажимаем на необходимую для настройки кнопку в матрице кнопок, и в правой части экрана выбираем Regular Button. Далее необходимо заполнить действия для этой кнопки.

![](/static/notes/companion/011.png)

Я решил сделать кнопку **Full** для grandMA2:

![](/static/notes/companion/012.png)

> Обратите внимание, что необходимо заполнять действие не только на нажатие кнопки, но ещё и на отпускание! В противном случае кнопка в пульте останется нажатой, даже после отпускания кнопки в Stream Deck.

На этом моменте всё уже должно работать: нажатие кнопки на Stream Deck должно посылать команду Full в grandMA. Аналогичным образом можно делать и другие команды, причем не только для grandMA. Можно добавить подключение для другого устройства, например, медиасервера, звукового пульта и т.д., и с одной панели кнопок управлять сразу всем. Главное помните про правильную [настройку сети](/light/network/).

А ещё не обязательно иметь физическую клавиатуру Stream Deck. Внутри компаньона можно запустить эмулятор:

![](/static/notes/companion/013.png)

И откроется вкладка с виртуальными кнопками, которая очень удобно может использоваться на планшете

![](/static/notes/companion/014.png)

Но опять же помните про сеть: для доступа к компаньону с внешних устройств его нужно в стартовом окне запустить не на адресе 127.0.0.1, а на том адресе, который будет доступен в вашей сети с внешними устройствами.